LOAD CSV WITH HEADERS FROM "file:/Users/simon/Dropbox/Auftr채ge_OCDM/neo4j/Patient.csv" AS row

CREATE (:Patient {name:row.name, id:row.id, geschlecht: row.geschlecht, gebdatum: row.gebdatum, lkontakt: row.lkontakt, status: row.status,  todesursache: row.todesursache});


LOAD CSV WITH HEADERS FROM "file:/Users/simon/Dropbox/Auftr채ge_OCDM/neo4j/Aufenthalt.csv" AS row
CREATE (:Aufenthalt {beginn: row.beginn, ende: row.ende, grund: row.grund, grundneu: row.grundneu,  id: row.id});


CREATE INDEX ON :Patient(id);
CREATE INDEX ON :Aufenthalt(id);

USING PERIODIC COMMIT
LOAD CSV WITH HEADERS FROM "file:/Users/simon/Dropbox/Auftr채ge_OCDM/neo4j/Aufenthalt.csv" AS row
MATCH (pat:Patient {id: row.id_patient})
MATCH (auf:Aufenthalt {id: row.id})
MERGE (pat)-[:AUF]->(auf);


LOAD CSV WITH HEADERS FROM "file:/Users/simon/Dropbox/Auftr채ge_OCDM/neo4j/Diagnose.csv" AS row
CREATE (:Diagnose {beginn: row.beginn, ende: row.ende, grund: row.grund, grundneu: row.grundneu,  id: row.id});
